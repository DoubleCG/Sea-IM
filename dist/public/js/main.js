function main(e,n,t,i,a){!function(e){function n(){for(var e=0;e<$(".sOption").length;e++)$(".sOption").eq(e).css("background","#333"),$(".sOption").eq(e).css("background","#fff");for(var n=0;n<$(".sContent").length;n++)$(".sContent").eq(n).css("display","none")}var t=e;$("#logOff").click(function(){window.location.href="/logOff"}),$("#person").click(function(){var e={username:t};formPostUrl("/people",e)}),$("#myteam").click(function(){var e={username:t};formPostUrl("/myteam",e)}),$("#buildTeam").click(function(){var e={username:t};formPostUrl("/buildTeam",e)}),$("#starOption").click(function(){n(),$(this).css("background","transparent"),$(this).css("color","#222"),$("#starContent").css("display","block")}),$("#teamOption").click(function(){n(),$(this).css("background","transparent"),$(this).css("color","#222"),$("#teamContent").css("display","block")}),$("#strangeOption").click(function(){n(),$(this).css("background","transparent"),$(this).css("color","#222"),$("#strangeContent").css("display","block")})}(e),function(e,n){var t=e,i=/&#34;/g,n=JSON.parse(n.replace(i,'"'));$("#user_info").append("<div id='avator'></div><div id='intro'></div><div id='set'><span class='glyphicon glyphicon-list' aria-hidden='true'></span></div>"),$("#avator").append("<img src="+n.headImg+">"),$("#intro").append("<div id='name'></div><div id='introduce'>"+n.introduce+"</div>"),$("#name").append("<div id='nickname'>"+n.nickname+"</div><div id='user_name'>"+t+"</div>"),$("#set").click(function(){var e=$("#domore");void 0===e.__proto__.judge&&(e.__proto__.judge=!1),e.judge?$("#domore").css("width","0px"):$("#domore").css("width","60px"),e.__proto__.judge=!e.__proto__.judge}),$(".sContent").click(function(){$("#domore").css("width","0px"),domore.__proto__.judge=!1})}(e,n),function(e){function n(){$("#search-content #search-info")&&$("#search-content #search-info").remove()}function t(){var e=$("#search-id").val().trim();if(e&&e!==i){$("#search-id").css("width","60%");var n={username:i,id:e},t=JSON.stringify(n);$.post("/search","J_data="+t,function(n){var t=n.team,a=n.person;$("#search-content").append("<div id='search-info'></div>"),t?($("#search-info").append("<div id='search-team'></div>"),$("#search-team").append("<div id='teamImg'><img src="+t.headImg+"></div><div id='tinfo'></div><div id='join'> <span class='glyphicon glyphicon-map-marker' aria-hidden='true'></span>  Join in</div>"),$("#tinfo").append("<div id='teamname'>团队名: "+t.teamname+"</div>"),$("#tinfo").append("<div id='builder'>ID: "+t.id+"</div>"),$("#tinfo").append("<div id='level'>级别: "+t.level+"</div>"),$("#tinfo").append("<div id='membernumber'>人数: "+t.membernumber+"</div>"),$("#tinfo").append("<div id='major'>主修: "+t.major+"</div>"),$("#tinfo").append("<div id='teamintro'>简介: "+t.introduce+"</div>"),$("#join").click(function(){var n={username:i,id:e},t=JSON.stringify(n);$.post("/join_judge","J_data="+t,function(e){"ok"===e?formPostUrl("/join",n):$("#search-team").append("<li class='alert alert-info' role='alert'>已经加入过这个团队</li>")})})):$("#search-info").append("<li  class='alert alert-warning' role='alert'>没有该团队</li>"),a?($("#search-info").append("<div id='search-person'></div>"),$("#search-person").append("<div id='personImg'><img src="+a.headImg+"></div><div id='pinfo'></div>"),$("#search-person").append("<div id='send'><span class='glyphicon glyphicon-envelope' aria-hidden='true'>Mess</div><div id='star'><span class='glyphicon glyphicon-star-empty' aria-hidden='true'></span>Star</div><div id='sms'></div>"),$("#pinfo").append("<div id='nickname'>昵称: "+a.nickname+"</div>"),$("#pinfo").append("<div id='sex'>性别: "+a.sex+"</div>"),$("#pinfo").append("<div id='hobby'>爱好: "+a.hobby+"</div>"),$("#pinfo").append("<div id='personIntro'>简介: "+a.introduce+"</div>"),$("#sms").append("<textarea></textarea>"),$("#sms").append("<div id='tosend'>发送<span class='glyphicon glyphicon-share-alt' aria-hidden='true'></span></div>"),$("#send").click(function(){$("#sms").css("height","120px")}),$("#star").click(function(){var n={id:e,username:i},t=JSON.stringify(n);$.post("/star","J_data="+t,function(e){var n=JSON.parse(e);n?($("#search-person").prepend("<li class='alert alert-success' role='alert'>成功标记该用户!</li>"),createStarLi(i,n)):$("#search-person").prepend("<li class='alert alert-success' role='alert'>已经标记该用户！</li>")})}),$("#tosend").click(function(){var n=$("#sms textarea"),t=n.val().trim(),a=$("#tosend");if(!t.length)return!1;if(t.length>60)return a.css("border","solid 1px red"),a.text("字数不能超过6０"),setTimeout(function(){a.css("border","none"),a.text("发送")},2e3),!1;var s=/[\n"\\]/g;t=t.replace(s,"");var r={to:e,from:i,content:t},o=JSON.stringify(r);socket.emit("peopleChat",o),n.val("Send!"),setTimeout(function(){n.val("")},1e3),n.focus(function(){n.val("")})})):$("#search-info").append("<li  class='alert alert-danger' role='alert'>没有该用户</li>")})}}var i=e;$("#search-content close").click(function(){$("#search-id").val(""),$("#search-id").css("width","70%"),n()}),$("#sub").click(function(){n(),t()}),$("#search-id").keyup(function(e){13===(e.keyCode||e.which||e.charCode)&&(n(),t())})}(e),function(e,n,t){function i(e,n,t){if(n.length){var i=document.createElement("p");i.innerText="["+ytime()+"] ME: "+n;var a=e.parent().siblings("content");a.append(i),a[0].scrollTop=a[0].scrollHeight;var r={content:n,to:t,from:s},o=JSON.stringify(r);socket.emit("peopleChat",o)}}var s=e,t=t;socket.on(s,function(e){for(var n,a=JSON.parse(e),r=$("messageframe"),o=0;o<t.length;o++)if(a.from===t[o]){n=!0;break}if(n)if(console.log("5000"),console.log(r.length),console.log(!r.length),console.log(typeof!r.length),r.length||(console.log(666),document.getElementById("tipvoice").play()),r.find("username").text()===a.from){var c=r.find("cont");(p=document.createElement("p")).innerText="["+ytime()+"]-:"+a.content,c.append(p),c[0].scrollTop=c[0].scrollHeight}else{for(var d=$("#starContent").find("username"),o=0;o<d.length;o++)d[o].innerText===a.from&&($(d[o]).siblings(".badge").length||$(d[o]).after('<span class="badge">!</span>'));$("#starOption .badge").length||$("#starOption").append('<span class="badge">!</span>').click(function(){$("#starOption .badge").remove()})}else{$("#strangeOption .badge").length||$("#strangeOption").append('<span class="badge">!</span>').click(function(){$("#strangeOption .badge").remove()});var p=document.createElement("p");p.innerText="["+ytime()+"] -:"+a.content;for(var l=$("#strangeContent ul li username"),m=!0,o=0;o<l.length;o++)if(l[o].innerText===a.from){$(l[o]).siblings(".badge").length||(console.log(),$(l[o]).after('<span class="badge">!</span>'),$(l[o]).parents("li").click(function(){$(this).find(".badge").remove()}));var f=$(l[o]).siblings("content");f.append(p),f[0].scrollTop=f[0].scrollHeight,m=!1;break}if(!m)return!1;$("#strangeContent ul").prepend("<li></li>");var u=$("#strangeContent ul").find("li").first();u.append('<username></username><close><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></close><content></content><div><input></input><sub_btn>发送<span class="glyphicon glyphicon-share-alt" aria-hidden="true"></span></sub_btn></div>'),u.find("username").text(a.from),u.find("username").after('<span class="badge">!</span>'),u.click(function(){$(this).find(".badge").remove(),$(this).siblings().css("height","40px"),$(this).css("height","350px")}),u.find("close").click(function(){$(this).parent().remove();var e=$(this).siblings("username").text(),n={username:s,str_username:e},t=JSON.stringify(n);$.post("/close_str_mess","J_data="+t)}),u.find("content").append(p),u.find("input").keyup(function(e){if(13!==(e.keyCode||e.which||e.charCode))return!1;var n=this.value.trim(),t=$(this).parent().siblings("username").text();this.value="",i($(this),n,t)}),u.find("sub_btn").click(function(){var e=$(this).siblings("input").val().trim(),n=$(this).parent().siblings("username").text();$(this).siblings("input").val(""),i($(this),e,n)})}});var r=/&#34;/g,n=JSON.parse(n.replace(r,'"'));for(var o in n.sta)c=n.sta[o],createStarLi(s,c);for(var o in n.str){var c=n.str[o];$("#strangeContent ul").append("<li></li>");var d=$("#strangeContent ul").find("li").last();d.append('<username></username><close><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></close><content></content><div><input></input><sub_btn>发送<span class="glyphicon glyphicon-share-alt" aria-hidden="true"></span></sub_btn></div>'),d.find("username").text(o),d.click(function(){$(this).find(".badge").remove(),$(this.parentNode).find(".badge").length||$("#strangeOption").find(".badge").remove(),$(this).siblings().css("height","40px"),$(this).css("height","350px")}),d.find("close").click(function(){$(this).parent().remove();var e=$(this).siblings("username").text(),n={username:s,str_username:e},t=JSON.stringify(n);$.post("/close_str_mess","J_data="+t)});for(var p=0;p<c.length;p++){var l=document.createElement("p");l.innerText="["+c[p].time+"] -: "+c[p].content,d.find("content").append(l)}d.find("input").keyup(function(e){if(13!==(e.keyCode||e.which||e.charCode))return!1;var n=this.value.trim(),t=$(this).parent().siblings("username").text();this.value="",i($(this),n,t)}),d.find("sub_btn").click(function(){var e=$(this).siblings("input").val().trim(),n=$(this).parent().siblings("username").text();$(this).siblings("input").val(""),i($(this),e,n)})}!function(e,n){var t=e,i=/&#34;/g,a=n.replace(i,'"'),n=JSON.parse(a),s=$("#teamContent ul");n.forEach(function(e){s.append("<li></li>");var n=s.find("li").last();n.append("<info><div><teamname></teamname><id></id></div><introduce></introduce></info><avator><img></avator>"),n.find("teamname").text(e.name),n.find("id").text(e.id),n.find("introduce").text(e.intro),n.find("avator img").attr("src",e.avator),socket.on("team"+e.id,function(e){function n(){$("#teamOption .badge").length||$("#teamOption").append('<span class="badge">!</span>').click(function(){$(this).find(".badge").remove()});for(var e=$("#teamContent").find("id"),n=0;n<e.length;n++)if(e[n].innerText===i.to){$(e[n]).after('<span class="badge">!</span>'),$(e[n]).parents("li").click(function(){$(this).find(".badge").remove(),$(this.parentNode).find(".badge").length||$("#teamOption").find(".badge").remove()});break}}var i=JSON.parse(e),a=$("messageframe");if(i.from!==t)if(a.length)if(a.find("id").text()===i.to){var s=a.find("cont"),r=document.createElement("p");r.innerText="["+i.time+"]"+i.from+":"+i.content,s.append(r),s[0].scrollTop=s[0].scrollHeight}else n();else console.log(777),document.getElementById("tipvoice").play(),n()}),n.click(function(){function n(e){if(e.length){var n=$("messageframe").find("cont"),i=document.createElement("p");i.innerText="["+ytime()+"] ME:"+e,n.append(i),n[0].scrollTop=n[0].scrollHeight;var s={content:e,time:ytime(),to:a,from:t},r=JSON.stringify(s);socket.emit("teamChat",r)}}$("messageframe")&&$("messageframe").remove(),$("#content").append("<messageframe></messageframe>");var i=$("messageframe");i.append('<top><close><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span></close><div><teamname></teamname><id></id></div><info><span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"></span></info></top>'),i.append("<cont></cont>"),i.append('<say><face></face><input></input><subm><span class="glyphicon glyphicon-share-alt" aria-hidden="true"></span></subm></say>'),$("messageframe top div teamname").text("[Team] "+e.name);var a=$(this).find("id").text();$("messageframe top div id").text(a),$.post("/get_team_mess","data="+a,function(e){var n;if((n="string"==typeof e?JSON.parse(e):e).length)for(var t=0;t<n.length;t++){var i=document.createElement("p");i.innerText="["+n[t].time+"]"+n[t].from+":\n"+n[t].content,$("messageframe cont").append(i)}}),$("messageframe top close").click(function(){$("messageframe").remove()}),$("messageframe say input").keyup(function(e){if(13===(e.keyCode||e.which||e.charCode)){var t=$(this).val().trim();this.value="",n(t)}}),$("messageframe say subm").click(function(){var e=$(this).siblings("input"),t=e.val();e.val(""),n(t)})})})}(e,a)}(e,t,i)}function createStarLi(e,n){$("#starContent ul").append("<li></li>");var t=$("#starContent ul").find("li").last();t.append("<info><div><nickname></nickname><username></username></div><introduce></introduce></info><avator><img></avator>"),t.find("nickname").text(n.nickname),t.find("username").text(n.username),t.find("introduce").text(n.introduce),t.find("avator img").attr("src",n.headImg),t.click(function(){$(this).find(".badge").remove(),$(this.parentNode).find(".badge").length||$("#starOption").find(".badge").remove(),$("messageframe")&&$("messageframe").remove(),$("#content").append("<messageframe></messageframe>"),$("messageframe").append("<top></top><cont></cont><say></say>"),$("messageframe top").append('<close><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span></close><div><nickname></nickname><username></username></div><info><span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"></span></info>'),$("messageframe say").append('<face></face><input></input><subm><span class="glyphicon glyphicon-share-alt" aria-hidden="true"></span></subm>'),$("messageframe top div nickname").text($(this).find("nickname").text()),$("messageframe top div username").text($(this).find("username").text());var n=$(this).find("username").text(),t={username:e,star_username:n},i=JSON.stringify(t);$.post("/get_star_mess","J_data="+i,function(e){e.forEach(function(e){var n=document.createElement("p");n.innerText="["+e.body.time+"] -:"+e.body.content;var t=$("messageframe cont");t.append(n),t[0].scrollTop=t[0].scrollHeight})}),$("messageframe close").click(function(){$("messageframe").remove()}),$("messageframe input").keyup(function(n){if(13!==(n.keyCode||n.which||n.charCode))return!1;starMessageEmit(e)}),$("messageframe subm").click(function(){starMessageEmit(e)})})}function starMessageEmit(e){var n=$("messageframe"),t=n.find("cont"),i=n.find("username").text(),a=n.find("input").val();if(a.length){var s={content:a,to:i,from:e},r=JSON.stringify(s);socket.emit("peopleChat",r);var o=document.createElement("p");o.innerText="["+ytime()+"] ME:"+a,t.append(o),t.scrollTop(t[0].scrollHeight),n.find("input").val("")}}