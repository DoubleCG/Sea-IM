<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<title>加入团队</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<!--[if lt IE 9]>
<link href="https://cdn.bootcss.com/bootstrap/2.0.4/css/bootstrap.min.css" rel="stylesheet">
<![endif]-->
<!--[if gte IE 9]><!-->
	<link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
<!--<![endif]-->
	<style>
	body{
        background:url('../img/014.jpg') no-repeat ;
        background-size:100%;
    }
    @media (max-width: 970px) {
        body{
            background-size:1000px 600px;
        }
    }
		.container{
			border:solid 2px #6a5;
			width:400px;
			height:150px;
			display: block;
			margin:20% auto;
			padding:1em;
		}
		tip{
			display: block;
		}
		#tip{
			color:red;
		}
	</style>

</head>
<body>

	<div class="container" id='join'>
		<h4>请输入该团队的口令：</h4>
		<p id='tip'></p>
		<input id='pw' />
		<button v-on:click='ok'>确认</button>
		<button v-on:click='test'>返回主页</button>
	</div>



<!--[if lt IE 9]>
<script src="https://cdn.staticfile.org/jquery/1.8.3/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/2.0.1/bootstrap.min.js"></script>
<![endif]-->
<!--[if gte IE 9]><!-->
<script src="https://cdn.bootcss.com/vue/2.4.2/vue.js"></script>
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<!--<![endif]-->
<script src='js/lib.js'></script>
<!-- <script src="js/index.js"></script> -->

<script>
var join = new Vue({
	el:'#join',
	data:{
		uidEnsure:{ uid:'<%=uid%>' },
	},
	methods:{
		test:function(){
			console.log(document.getElementById('pw').value.trim())
			console.log(this.okEnsure.password)
		},
		back:function(){ formPostUrl('/main',this.uidEnsure); },
		ok:function(){
			var okEnsure = {
				password:document.getElementById('pw').value.trim(),
				uid:'<%=uid%>',
				tid:'<%=tid%>',
			}
			console.log(okEnsure)
			var J_data = JSON.stringify(okEnsure);
			var xmlhttp = new XMLHttpRequest();
			xmlhttp.open("POST","/join_ok",true);
			xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
			xmlhttp.send("J_data="+J_data);
			xmlhttp.onreadystatechange=function(){
 				if(xmlhttp.readyState==4 && xmlhttp.status==200){
 					var judge = JSON.parse(xmlhttp.responseText);
 					console.log(judge)
 					console.log(typeof judge)
 					if(judge){ join.back();}
 					else{  document.getElementById('tip').innerText='Password error.'; }
 				}
 			}
		}
	}
});


</script>	
</body>
</html>