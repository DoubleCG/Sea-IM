<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<title>Seanet-Chat</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="css/main.css">

</head>


<body >


<div class='container' id='main' >
	<div id="content" >
		<domore-part></domore-part>
		<div id="checkMess" >
			<user-info
				user_info="<%=user_info%>"
			></user-info>
			<search-content></search-content>
			<div id="messOption" v-on:click='hideDomore'>
				<div 
					v-on:click="listSeen($event,'recent')" 
					id='recentOption' 
					class='sOption'
				>
					<span 
						class="glyphicon glyphicon-pencil" 
						aria-hidden="true"
					></span>
				</div>
				<div 
					v-on:click="listSeen($event,'star')" 
					id='starOption' 
					class='sOption'
				>
					<span 
						class="glyphicon glyphicon-star" 
						aria-hidden="true"
					></span>
				</div>
				<div 
					v-on:click="listSeen($event,'team')" 
					id='teamOption'
					class='sOption'
					>
					<span
						class="glyphicon glyphicon-fire"
						aria-hidden="true"
					></span>
				</div>
			</div>
			<div
				id="messContent"
				v-on:click='hideDomore'
			>
				<div
					v-show="messShowType === 'recent'"
					id="recentContent"
					class='sContent'
				>
					<mess-lis 
						type='recent'
						v-bind:info = 'recentInfo'
					></mess-lis>
				</div>
				<div
					v-show="messShowType === 'star'"
					id="starContent"
					class='sContent'
				>
					<mess-lis
						type='star'
						v-bind:info = 'starInfo'
					></mess-lis>
				</div>
				<div
					v-show="messShowType === 'team'"
					id="teamContent"
					class='sContent'
				>
					<mess-lis
						type = 'team'
						v-bind:info = 'teamInfo'
					></mess-lis>
				</div>
			</div>
		</div>
	</div>
</div>

<%include frameuse.ejs%>

<script src="/socket.io/socket.io.js"></script>
<script>var socket = io();</script>

<script>
/*声音资源*/
var LoginSound = new Audio('voice/successLogin.wav');
var TeamMessageCome = new Audio('voice/tmessageCome.wav');
var PersonMessageCome = new Audio('voice/pmessageCome.wav');



LoginSound.play();

const Uid = '<%=uid%>';
const userEnsure = {
  uid:Uid
};

var loginlist = JSON.parse(jsonKeep('<%=loginlist%>'));
var punRead = JSON.parse(jsonKeep('<%=punRead%>'));
var tunRead = JSON.parse(jsonKeep('<%=tunRead%>'));
var recentInfo = JSON.parse(jsonKeep('<%=recentinfo%>'));
var starInfo = JSON.parse(jsonKeep('<%=starinfo%>'));
var teamInfo = JSON.parse(jsonKeep('<%=teaminfo%>'));



console.log(recentInfo);
console.log(starInfo);
console.log(teamInfo);


for(var i of recentInfo){
	var isTeam = Boolean(recentInfo.level);
	var uid = i.uid;
	i.unread = (isTeam)?tunRead[uid]:punRead[uid];		
}

for(var i of starInfo){
	i.unread = punRead[i.uid];
}

for(var i of teamInfo){
	i.unread = tunRead[i.uid];
}


</script>

<script src='js/main-help.js'></script>
<script src='js/main-domorepart.js'></script>
<script src='js/main-userinfo.js'></script>
<script src='js/main-search.js'></script>
<script src='js/main-messli.js'></script>
<script src='js/main-messageframe.js'></script>
<script src='js/main-methods.js'></script>
<script src='js/main-content.js'></script>


</body>
</html>